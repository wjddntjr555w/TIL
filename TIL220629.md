# Daily to do list
## Java 

- - -
## Spring   
데이터 접근 기술
-- - -
## CS    

- - -
## 알고리즘    

---------
# 오늘의 회고

220629 SPRING DB



——————————————————
MyBatis

마이바티스 장점 = SQL을 XML에 편리하게 작성할 수 있고 가장 중요한 장점은 동적 쿼리를 매우 편리하게 작성할 수 있다


￼
이런식으로 동적 쿼리를 손쉽게 작성할 수 있다.

단점 : MyBatis는 JdbcTemplate에 비하여 약간의 설정이 필요하다. (큰 단점은 아님)

정리 :
프로젝트에서 동적 쿼리와 복잡한 쿼리가 많으면 MyBatis


￼
패키지 명을 자동으로 인식? 해주는 것 (나중에 패키지 명을 생략할 수 있음)
카멜 표기법으로 자동 변환
로그 레벨 trace로 변환

￼
언더스코어 표기법을 자동으로 카멜로 변환시켜준다..

——————————————
MyBatis 적용

￼
이런식으로 Mapper 인터페이스를 만들어줘야함 @Mapper를 붙여야지 인식하며 자세한 쿼리는 따로 xml 파일로 만들어 줌(resources 폴더에 디렉토리를 Mapper와 완전 동일하게 만들어주고 파일이름도 동일하게 만들어준다.[네임스페이스로도 가능])

￼
이런식으로 쿼리문 작성 가능.
파라미터는 #{}를 사용해서 넣어준다.

useGeneratedKeys << 키 자동 생성
KeyProperty << 자동생성 키 이름
resultType << 반환값 타입 설정

파라미터가 여러개이면 .으로 구분해서 사용 ex) updateParam.itemName
 
￼
이런식으로 if문을 즉 동적쿼리를 사용할 수 있음
<where>를 사용하면 자동으로 and도 붙여주고 알아서 해준다

￼

———————————
MyBatis 적용 분석..

ItemMapper 인터페이스의 구현체가 없는데 동작하는 이유

￼

xml파일까지 합쳐져서 받음 @Mapper가 붙은 인터페이스 조사해서 구현체를 만들어주고 구현체를 스프링 빈으로 등록

정리 :
매퍼 구현체 덕분에 마이바티스를 스프링에 편리하게 통합해서 사용할 수 있음
매퍼 구현체를 사용하면 스프링 예외 추상화도 함께 적용됨
데이터베이스 커넥션, 트랜잭션과 관련된 기능 등 여러가지 동기화하고 연동 해준다.


——————————————
마이바티스 기능 정리 - 동적 쿼리


** if
조건에 따라 추가할지 말지 판단

** choose (when, otherwise)
자바의 switch 구문과 유사한 구문

** trim (where, set)
￼
이렇게 <> 태그로 where를 사용하거나 하면 문장이 AND나 혹은 아무 것도 만족하지 못해서 SQL문장이 어색해질 경우를 방지해줌

** foreach
컬렉션을 반복 처리할 때 사용한다. where in (1,2,3,4,5,6)와 같은 문장을 쉽게 완성할 수 있다.
파라미터로 List를 전달하면 된다.


—————————————————
MyBatis 기능 정리 - 기타 기능

** 애노테이션으로 SQL 작성
￼


** 문자열 대체
#{}문법은 ?를 넣고 파라미터를 바인딩하는 PreparedStatement를 사용..
때로는 파라미터 바인딩이 아닌 문자 그대로를 처리하고 싶은 경우 ${}를 사용하면 된다.
￼
***** 주의….. SQL인잭션 공격을 당할 수 있다.

** 재사용 가능한 SQL 조각

￼
중복 되는 sql 조각을 재사용할 수 있음.

** Result Maps
결과를 매핑할 때 테이블은 user_id 이지만 객체는 id일 경우?!
￼
보통 별칭을 사용하지만 resultMap으로 매핑도 가능

￼

정리

MyBatis 장점 : sql 여러줄을 입력 가능, 동적 쿼리,<

